extends ./layout_medic

block content
  .container.mt-4
    h1.mb-4.text-primary SUS - Panel del médico

    p.mb-2
      | Médico: 
      strong #{medic.User.fullname}

    p.mb-2
      | Especialidad: 
      strong #{medic.Specialty.name} 
      |  | Centro: 
      strong #{medic.HealthCenter.name}


    hr

    h2.mb-3 Citas agendadas para hoy

    p.mb-3
      | Fecha: 
      strong #{dateStr}

    if slots.length === 0
      .alert.alert-info No tienes citas para hoy.

    else
      table.table.table-striped.table-bordered
        thead.table-dark
          tr
            th Hora
            th Paciente
            th Motivo / Tipo
            th Estado
            th Acciones
        tbody
          each s in slots
            tr
              td= s.time
              td= s.Patient.User.fullname

              td
                if s.Appointment
                  | #{s.Appointment.reason || s.Appointment.type || "—"}
                else
                  | —

              td
                if s.Appointment
                  if s.Appointment.status === "attended"
                    span.text-success.fw-bold Atendida ✔
                  else if s.Appointment.status === "no_show"
                    span.text-danger.fw-bold No se presentó ❌
                  else
                    span.text-warning Pendiente
                else
                  | —

              td
                if s.Appointment
                  if s.Appointment.status === "pending"
                    a.btn.btn-success.btn-sm.me-1(href=`/medic/slot/${s.id}/attend`) Atender
                    a.btn.btn-warning.btn-sm(href=`/medic/slot/${s.id}/no_show`) No se presentó
                  else
                    span.text-muted.me-1 Atender (bloqueado)
                    span.text-muted No se presentó (bloqueado)
                else
                  | —
